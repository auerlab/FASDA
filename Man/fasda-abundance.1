.TH FASDA-ABUNDANCE 1
.SH NAME    \" Section header
.PP

fasda abundance - Compute abundances from SAM data

\" Convention:
\" Underline anything that is typed verbatim - commands, etc.
.SH SYNOPSIS
.PP
.nf 
.na 
fasda abundance \\
    --debug \\
    --show-gene-name \\
    --ignore-chromosome-order \\
    --feature-type mRNA|transcript|gene (default = mRNA) \\
    --output-dir dir (default=same as SAM/BAM/CRAM input) \\
    features.gff3 alignment-file [alignment-file ...]
.ad
.fi

.SH "DESCRIPTION"
.B "fasda abundance"
computes raw read counts from one or more SAM/BAM/CRAM files overlapping
each features in a GFF3 file.  Output is an abundance.tsv file in the
same format as those produced by kallisto.  Estimated counts may not match
those produced by kallisto as they are calculated differently.  However,
the ratio of kallisto counts / fasda counts should be fairly consistent,
so that fold-changes produced by 
.B fasda fold-change
are highly similar.

Abundances in the output are raw counts of properly paired reads that are
not flagged as secondary alignments, failed QC, duplicate, or supplementary.
For paired-end reads, both mates are counted separately, so the counts
should be expected to reflect about double the number of fragments aligned.

Any normalization of counts is left to downstream tools such as
.B fasda-normalize(1).

.SH OPTIONS
.TP
\fB--debug
Turn on debugging output

.TP
\fB--show-gene-name
Show gene name rather than feature (mRNA/transcript) name in output.

.TP
\fB--ignore-chromosome-order
Do not abort if GFF3 or SAM input chromosomes are not sorted in order
determined by bl_chrom_name_cmp(3).  If this option is used, you must ensure
that the order of the chromosomes is the same in the GFF3 and SAM input.

.TP
\fB--feature-type=mRNA|transcript|gene\fR
Indicate what features in the GFF3 input reads were aligned to.
Should normally be mRNA, transcript, or gene, but the user is free
to use any string present in column 3 of the GFF3 file.
Default is mRNA.

.TP
\fB--output-dir=directory\fR
Indicate where -abundance.tsv output files should go.  The default
is the same directory is the SAM input.

.SH FILES
.nf
.na
features.gff3
alignment.bam
.ad
.fi

.SH "SEE ALSO"
fasda-normalize(1), fasda-fold-change(1)

.SH BUGS
Please report bugs to the author and send patches in unified diff format.
(man diff for more information)

.SH AUTHOR
.nf
.na
J. Bacon

